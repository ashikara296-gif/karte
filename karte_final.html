<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>ã‚„ã™ã‚‰ãæ•´ä½“é™¢ ã‚«ãƒ«ãƒ†ã‚·ã‚¹ãƒ†ãƒ </title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@300;400;600;700&family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
<style>
/* ===== VARIABLES ===== */
:root {
  --ink: #1c1510;
  --ink-mid: #4a3c2e;
  --ink-soft: #7a6a58;
  --cream: #faf5ec;
  --cream-2: #f2ead8;
  --cream-3: #e8dfc9;
  --gold: #b8935a;
  --gold-light: #d4b07a;
  --gold-pale: #f0e0c0;
  --teal: #2d6a6a;
  --teal-light: #4a9090;
  --red: #b03030;
  --green: #2a7a4a;
  --border: #d4c4a0;
  --border-light: #e8dcc4;
  --shadow-sm: 0 2px 8px rgba(60,40,10,0.10);
  --shadow-md: 0 4px 20px rgba(60,40,10,0.14);
  --shadow-lg: 0 8px 40px rgba(60,40,10,0.18);
  --radius: 6px;
  --transition: 0.22s cubic-bezier(0.4,0,0.2,1);
}

/* ===== RESET ===== */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
html { font-size: 16px; }
body {
  font-family: 'Noto Sans JP', sans-serif;
  background: var(--cream-3);
  color: var(--ink);
  min-height: 100vh;
  -webkit-font-smoothing: antialiased;
}

/* ===== PAGE LOAD ANIMATION ===== */
@keyframes fadeInUp {
  from { opacity: 0; transform: translateY(16px); }
  to   { opacity: 1; transform: translateY(0); }
}
.fade-in { animation: fadeInUp 0.5s ease both; }
.fade-in-2 { animation: fadeInUp 0.5s 0.1s ease both; }
.fade-in-3 { animation: fadeInUp 0.5s 0.2s ease both; }

/* ===== TOP HEADER ===== */
.top-header {
  position: sticky; top: 0; z-index: 100;
  background: var(--ink);
  border-bottom: 2px solid var(--gold);
  display: flex; align-items: center; justify-content: space-between;
  padding: 0 20px;
  height: 52px;
}
.header-logo {
  font-family: 'Noto Serif JP', serif;
  font-size: 1rem;
  letter-spacing: 0.18em;
  color: var(--cream);
  white-space: nowrap;
}
.header-logo em { color: var(--gold); font-style: normal; }
.header-right {
  display: flex; align-items: center; gap: 14px;
}
.header-staff {
  font-size: 0.7rem;
  color: var(--gold-pale);
  letter-spacing: 0.08em;
  display: none;
}
.hamburger {
  display: flex; flex-direction: column; gap: 5px;
  background: none; border: none; cursor: pointer; padding: 4px;
}
.hamburger span {
  display: block; width: 22px; height: 1.5px;
  background: var(--gold-light);
  transition: var(--transition);
}

/* ===== LAYOUT ===== */
.app-layout {
  display: flex;
  max-width: 1280px;
  margin: 0 auto;
  min-height: calc(100vh - 52px);
}

/* ===== SIDEBAR ===== */
.sidebar {
  width: 260px;
  flex-shrink: 0;
  background: var(--cream);
  border-right: 1px solid var(--border);
  display: flex;
  flex-direction: column;
  transition: transform var(--transition);
  overflow-y: auto;
}
.sidebar-inner { padding: 20px 14px; display: flex; flex-direction: column; gap: 20px; }

.sidebar-label {
  font-size: 0.62rem;
  letter-spacing: 0.22em;
  color: var(--gold);
  text-transform: uppercase;
  padding-bottom: 6px;
  border-bottom: 1px solid var(--border);
  margin-bottom: 6px;
}

.patient-item {
  display: flex; align-items: center; gap: 10px;
  padding: 10px 10px;
  border: 1px solid var(--border-light);
  border-radius: var(--radius);
  cursor: pointer;
  transition: var(--transition);
  background: var(--cream);
}
.patient-item:hover { background: var(--gold-pale); border-color: var(--gold-light); }
.patient-item.active {
  background: linear-gradient(135deg, #fff8ee 0%, #fdf0d8 100%);
  border-color: var(--gold);
  box-shadow: var(--shadow-sm);
}
.patient-avatar {
  width: 36px; height: 36px;
  border-radius: 50%;
  background: var(--ink);
  color: var(--gold);
  font-family: 'Noto Serif JP', serif;
  font-size: 0.78rem;
  display: flex; align-items: center; justify-content: center;
  flex-shrink: 0;
}
.patient-item.active .patient-avatar { background: var(--gold); color: var(--ink); }
.patient-info-text .p-name {
  font-size: 0.85rem; font-weight: 500;
  color: var(--ink);
}
.patient-info-text .p-meta {
  font-size: 0.67rem; color: var(--ink-soft);
  margin-top: 1px;
}
.patient-item .time-badge {
  margin-left: auto;
  font-size: 0.65rem;
  color: var(--teal);
  background: #e8f5f5;
  border: 1px solid #b0d8d8;
  padding: 2px 6px;
  border-radius: 10px;
  white-space: nowrap;
}

.new-btn {
  width: 100%;
  padding: 9px;
  background: var(--teal);
  color: #e0f2f2;
  border: none;
  font-family: 'Noto Sans JP', sans-serif;
  font-size: 0.75rem;
  letter-spacing: 0.12em;
  cursor: pointer;
  border-radius: var(--radius);
  transition: var(--transition);
  margin-top: 6px;
}
.new-btn:hover { background: var(--teal-light); }

.history-list { display: flex; flex-direction: column; gap: 2px; }
.history-row {
  display: flex; justify-content: space-between;
  font-size: 0.7rem; color: var(--ink-mid);
  padding: 4px 6px;
  border-bottom: 1px solid var(--border-light);
}
.history-row:last-child { border-bottom: none; }
.history-row .visit-n { color: var(--gold); }

/* ===== MAIN ===== */
.main-area {
  flex: 1;
  display: flex;
  flex-direction: column;
  min-width: 0;
  background: var(--cream-2);
}

/* ===== TABS ===== */
.tab-bar {
  display: flex;
  background: var(--cream);
  border-bottom: 2px solid var(--border);
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
}
.tab-bar::-webkit-scrollbar { display: none; }
.tab-btn {
  padding: 12px 20px;
  font-size: 0.75rem;
  letter-spacing: 0.1em;
  color: var(--ink-soft);
  cursor: pointer;
  border: none;
  background: none;
  border-bottom: 2.5px solid transparent;
  margin-bottom: -2px;
  white-space: nowrap;
  font-family: 'Noto Sans JP', sans-serif;
  transition: var(--transition);
}
.tab-btn.active {
  color: var(--ink);
  border-bottom-color: var(--gold);
  font-weight: 500;
  background: var(--cream-2);
}
.tab-btn:hover:not(.active) { color: var(--ink-mid); background: var(--cream-3); }

/* ===== TAB CONTENT ===== */
.tab-pane { display: none; }
.tab-pane.active { display: block; }

/* ===== SCROLL AREA ===== */
.scroll-area {
  flex: 1;
  overflow-y: auto;
  padding: 20px 16px;
}

/* ===== KARTE CARD ===== */
.karte-card {
  background: white;
  border: 1.5px solid var(--border);
  max-width: 820px;
  margin: 0 auto;
  box-shadow: var(--shadow-md);
  border-radius: 4px;
  overflow: hidden;
}

.karte-top {
  background: var(--ink);
  padding: 14px 20px;
  display: flex;
  align-items: center;
  justify-content: space-between;
}
.karte-top-left .karte-tag {
  font-size: 0.58rem;
  letter-spacing: 0.3em;
  color: var(--gold);
  text-transform: uppercase;
  margin-bottom: 3px;
}
.karte-top-left .karte-salon {
  font-family: 'Noto Serif JP', serif;
  font-size: 1.05rem;
  letter-spacing: 0.15em;
  color: var(--cream);
}
.karte-top-right { text-align: right; }
.karte-top-right .karte-no {
  font-size: 0.72rem;
  color: var(--gold-light);
  letter-spacing: 0.06em;
}
.karte-top-right .karte-date {
  font-size: 0.68rem;
  color: rgba(245,240,232,0.6);
  margin-top: 2px;
}

/* Patient info grid */
.info-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  border-bottom: 1.5px solid var(--border);
}
.info-col { border-right: 1px solid var(--border); }
.info-col:last-child { border-right: none; }
.info-row {
  display: grid;
  grid-template-columns: 82px 1fr;
  border-bottom: 1px solid var(--border-light);
  min-height: 34px;
}
.info-row:last-child { border-bottom: none; }
.lbl {
  background: #f8f0e0;
  font-size: 0.65rem;
  letter-spacing: 0.1em;
  color: var(--gold);
  padding: 0 10px;
  display: flex; align-items: center;
  border-right: 1px solid var(--border);
}
.val {
  font-size: 0.8rem;
  padding: 6px 12px;
  color: var(--ink);
  display: flex; align-items: center;
}
.val.name-val {
  font-family: 'Noto Serif JP', serif;
  font-size: 1rem;
  font-weight: 600;
}

/* Section */
.karte-section { border-bottom: 1px solid var(--border-light); }
.section-head {
  background: #f8f2e4;
  padding: 6px 16px;
  font-family: 'Noto Serif JP', serif;
  font-size: 0.68rem;
  letter-spacing: 0.2em;
  color: var(--gold);
  border-bottom: 1px solid var(--border);
  display: flex; align-items: center; gap: 8px;
}
.section-head::before {
  content: ''; width: 3px; height: 11px;
  background: var(--gold); flex-shrink: 0;
}

/* Body diagram */
.body-area {
  display: flex; gap: 16px;
  padding: 14px 16px;
  align-items: flex-start;
}
.body-svg-wrap { flex-shrink: 0; width: 100px; }
.body-svg-wrap svg { width: 100%; }
.pain-info { flex: 1; }
.pain-tag {
  display: inline-block;
  background: #fff0ee; border: 1px solid #e8a090;
  color: var(--red);
  font-size: 0.67rem; padding: 2px 8px;
  border-radius: 2px; margin: 2px;
  letter-spacing: 0.04em;
}
.pain-detail { margin-top: 10px; font-size: 0.72rem; color: var(--ink-mid); line-height: 1.9; }

/* Section body */
.sec-body { padding: 12px 16px; font-size: 0.8rem; color: var(--ink); line-height: 1.85; }

/* Visit record */
.visit-box {
  margin: 0 16px 14px;
  border: 1px solid var(--border);
  border-radius: 3px;
  overflow: hidden;
  background: #fffdf8;
}
.visit-head {
  background: var(--ink);
  color: var(--gold-pale);
  padding: 6px 14px;
  font-size: 0.67rem;
  letter-spacing: 0.14em;
  display: flex; justify-content: space-between;
}
.visit-body { padding: 10px 14px; }
.vrow { display: flex; gap: 10px; margin-bottom: 6px; font-size: 0.77rem; }
.vlbl {
  font-size: 0.65rem;
  color: var(--gold);
  letter-spacing: 0.1em;
  flex-shrink: 0;
  padding-top: 2px;
  min-width: 72px;
}

/* ===== VOICE PANEL ===== */
.voice-panel {
  background: var(--ink);
  border-top: 2px solid var(--gold);
  padding: 14px 16px;
}
.voice-panel-inner {
  display: flex; gap: 12px; align-items: flex-end;
  max-width: 820px; margin: 0 auto;
}
.mic-wrap { display: flex; flex-direction: column; align-items: center; gap: 6px; flex-shrink: 0; }
.mic-btn {
  width: 52px; height: 52px;
  border-radius: 50%;
  background: var(--gold);
  border: none; cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  transition: var(--transition);
  box-shadow: 0 0 0 0 rgba(184,147,90,0.4);
}
.mic-btn svg { width: 22px; height: 22px; fill: var(--ink); }
.mic-btn.rec {
  background: var(--red);
  animation: mic-pulse 1.2s infinite;
}
.mic-btn.rec svg { fill: white; }
@keyframes mic-pulse {
  0%   { box-shadow: 0 0 0 0 rgba(176,48,48,0.5); }
  70%  { box-shadow: 0 0 0 14px rgba(176,48,48,0); }
  100% { box-shadow: 0 0 0 0 rgba(176,48,48,0); }
}
.mic-label {
  font-size: 0.62rem;
  color: rgba(245,240,232,0.55);
  letter-spacing: 0.08em;
  white-space: nowrap;
}
.voice-input-area { flex: 1; min-width: 0; }
.voice-textarea {
  width: 100%;
  background: rgba(255,255,255,0.07);
  border: 1px solid rgba(184,147,90,0.35);
  border-radius: var(--radius);
  padding: 10px 13px;
  color: var(--cream);
  font-family: 'Noto Sans JP', sans-serif;
  font-size: 0.8rem;
  line-height: 1.7;
  min-height: 52px;
  max-height: 100px;
  resize: none; outline: none;
  transition: border-color var(--transition);
}
.voice-textarea::placeholder { color: rgba(245,240,232,0.28); font-size: 0.75rem; }
.voice-textarea:focus { border-color: rgba(184,147,90,0.7); }
.voice-hint { font-size: 0.62rem; color: rgba(245,240,232,0.35); margin-top: 5px; letter-spacing: 0.05em; }
.voice-btns { display: flex; flex-direction: column; gap: 7px; flex-shrink: 0; }
.vbtn {
  padding: 9px 14px;
  border: none; border-radius: 4px;
  font-family: 'Noto Sans JP', sans-serif;
  font-size: 0.7rem; letter-spacing: 0.1em;
  cursor: pointer; transition: var(--transition);
  white-space: nowrap;
  font-weight: 500;
}
.vbtn-parse { background: var(--gold); color: var(--ink); }
.vbtn-parse:hover { background: var(--gold-light); }
.vbtn-save  { background: var(--green); color: white; }
.vbtn-save:hover  { background: #359958; }

/* ===== SYSTEM TAB ===== */
.system-wrap { max-width: 820px; margin: 0 auto; }
.sys-card {
  background: white;
  border: 1.5px solid var(--border);
  border-radius: 4px;
  overflow: hidden;
  box-shadow: var(--shadow-sm);
  margin-bottom: 16px;
}
.sys-card-head {
  background: var(--ink);
  color: var(--gold-pale);
  padding: 10px 18px;
  font-family: 'Noto Serif JP', serif;
  font-size: 0.8rem;
  letter-spacing: 0.15em;
  display: flex; align-items: center; gap: 8px;
}
.sys-card-body { padding: 16px 18px; }

.flow-row {
  display: flex; align-items: center;
  flex-wrap: wrap; gap: 0;
  justify-content: center;
}
.flow-node {
  display: flex; flex-direction: column; align-items: center;
  padding: 10px 12px; text-align: center; min-width: 96px;
}
.flow-icon {
  width: 48px; height: 48px;
  border-radius: 50%;
  font-size: 22px;
  display: flex; align-items: center; justify-content: center;
  margin-bottom: 6px;
}
.fn-name { font-size: 0.78rem; font-weight: 500; color: var(--ink); }
.fn-sub  { font-size: 0.63rem; color: var(--ink-soft); margin-top: 1px; }
.fn-badge {
  display: inline-block;
  font-size: 0.58rem; padding: 2px 7px;
  border-radius: 10px; margin-top: 4px; letter-spacing: 0.06em;
}
.flow-arrow { color: var(--gold-light); font-size: 1.3rem; padding: 0 2px; margin-bottom: 30px; }

.feature-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
}
.feat {
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 14px;
  background: var(--cream);
}
.feat h4 {
  font-family: 'Noto Serif JP', serif;
  font-size: 0.78rem;
  color: var(--teal);
  margin-bottom: 7px;
  letter-spacing: 0.08em;
}
.feat p { font-size: 0.7rem; color: var(--ink-soft); line-height: 1.75; }

.sheet-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
}
.sheet-card { border: 1px solid var(--border); border-radius: var(--radius); overflow: hidden; }
.sheet-head {
  background: var(--teal);
  color: #e0f2f2;
  padding: 6px 12px;
  font-size: 0.68rem; letter-spacing: 0.12em;
}
.sheet-body {
  padding: 10px 12px;
  font-size: 0.7rem; color: var(--ink-mid); line-height: 2;
  background: #f8fefe;
}

.cost-row {
  display: flex; justify-content: space-between; align-items: center;
  padding: 8px 0; border-bottom: 1px solid var(--border-light);
  font-size: 0.78rem;
}
.cost-row:last-child { border-bottom: none; }
.cost-name { color: var(--ink-mid); }
.cost-free { color: var(--green); font-weight: 500; font-size: 0.82rem; }
.cost-note { color: var(--ink-soft); font-size: 0.68rem; }

/* ===== MOBILE OVERLAY ===== */
.sidebar-overlay {
  display: none;
  position: fixed; inset: 0; z-index: 199;
  background: rgba(20,14,8,0.55);
}
.sidebar-overlay.show { display: block; }

/* ===== RESPONSIVE ===== */

/* PC (â‰¥ 768px) */
@media (min-width: 768px) {
  .header-staff { display: block; }
  .hamburger { display: none; }
  .sidebar { position: static; z-index: auto; }
  .sidebar-overlay { display: none !important; }
  .scroll-area { padding: 24px 24px; }
  .voice-textarea { font-size: 0.82rem; }
  .feature-grid { gap: 14px; }
}

/* MOBILE (< 768px) */
@media (max-width: 767px) {
  .sidebar {
    position: fixed;
    top: 52px; left: 0; bottom: 0;
    z-index: 200;
    width: 78vw;
    max-width: 300px;
    transform: translateX(-100%);
    box-shadow: var(--shadow-lg);
  }
  .sidebar.open { transform: translateX(0); }
  .main-area { width: 100%; }
  .info-grid { grid-template-columns: 1fr; }
  .info-col { border-right: none; border-bottom: 1px solid var(--border); }
  .info-col:last-child { border-bottom: none; }
  .body-area { flex-direction: column; align-items: center; }
  .body-svg-wrap { width: 80px; }
  .feature-grid { grid-template-columns: 1fr; }
  .sheet-grid   { grid-template-columns: 1fr; }
  .voice-panel-inner { flex-wrap: wrap; }
  .voice-input-area { width: 100%; order: -1; }
  .voice-btns { flex-direction: row; width: 100%; }
  .vbtn { flex: 1; text-align: center; }
  .mic-wrap { flex-direction: row; gap: 10px; }
  .mic-label { margin-top: 0; }
  .flow-row { gap: 0; }
  .flow-arrow { transform: rotate(90deg); }
  .tab-btn { padding: 11px 14px; font-size: 0.72rem; }
  .scroll-area { padding: 14px 10px; }
  .karte-top { padding: 10px 14px; }
}

/* Extra small */
@media (max-width: 380px) {
  .header-logo { font-size: 0.88rem; }
  .karte-salon { font-size: 0.92rem !important; }
  .voice-btns { flex-direction: column; }
  .vbtn { flex: none; }
}

/* ===== SCROLLBAR ===== */
::-webkit-scrollbar { width: 5px; height: 5px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }
</style>
</head>
<body>

<!-- TOP HEADER -->
<header class="top-header">
  <div class="header-logo">ã‚„ã™ã‚‰ã<em>æ•´ä½“é™¢</em> ã‚«ãƒ«ãƒ†</div>
  <div class="header-right">
    <div class="header-staff">æ–½è¡“è€…ï¼šç”°ä¸­ èŠ±å­</div>
    <button class="hamburger" id="menuBtn" onclick="toggleMenu()" aria-label="ãƒ¡ãƒ‹ãƒ¥ãƒ¼">
      <span></span><span></span><span></span>
    </button>
  </div>
</header>

<!-- SIDEBAR OVERLAY -->
<div class="sidebar-overlay" id="overlay" onclick="closeMenu()"></div>

<!-- LAYOUT -->
<div class="app-layout">

  <!-- SIDEBAR -->
  <aside class="sidebar" id="sidebar">
    <div class="sidebar-inner">

      <div>
        <div class="sidebar-label">æœ¬æ—¥ã®æ‚£è€…</div>
        <div style="display:flex;flex-direction:column;gap:7px">
          <div class="patient-item active" onclick="selectPatient(this,'å±±ç”° å¤ªéƒ')">
            <div class="patient-avatar">å±±</div>
            <div class="patient-info-text">
              <div class="p-name">å±±ç”° å¤ªéƒ</div>
              <div class="p-meta">60æ­³ãƒ»ç”·æ€§</div>
            </div>
            <span class="time-badge">13:00</span>
          </div>
          <div class="patient-item" onclick="selectPatient(this,'ä½è—¤ ã¿ã')">
            <div class="patient-avatar" style="background:#2d6a6a;color:#e0f2f2">ä½</div>
            <div class="patient-info-text">
              <div class="p-name">ä½è—¤ ã¿ã</div>
              <div class="p-meta">38æ­³ãƒ»å¥³æ€§</div>
            </div>
            <span class="time-badge">14:30</span>
          </div>
          <div class="patient-item" onclick="selectPatient(this,'éˆ´æœ¨ ä¸€éƒ')">
            <div class="patient-avatar" style="background:#5a4030;color:#f0e0c0">éˆ´</div>
            <div class="patient-info-text">
              <div class="p-name">éˆ´æœ¨ ä¸€éƒ</div>
              <div class="p-meta">45æ­³ãƒ»ç”·æ€§</div>
            </div>
            <span class="time-badge">16:00</span>
          </div>
        </div>
        <button class="new-btn" onclick="alert('æ–°è¦æ‚£è€…ç™»éŒ²ãƒ•ã‚©ãƒ¼ãƒ ã‚’é–‹ãã¾ã™')">ï¼‹ æ–°è¦æ‚£è€…ã‚’ç™»éŒ²</button>
      </div>

      <div>
        <div class="sidebar-label">æ¥é™¢å±¥æ­´</div>
        <div class="history-list">
          <div class="history-row"><span>2025.06.18</span><span class="visit-n">5å›ç›®</span></div>
          <div class="history-row"><span>2025.06.04</span><span class="visit-n">4å›ç›®</span></div>
          <div class="history-row"><span>2025.05.21</span><span class="visit-n">3å›ç›®</span></div>
          <div class="history-row"><span>2025.05.07</span><span class="visit-n">2å›ç›®</span></div>
          <div class="history-row"><span>2025.04.22</span><span class="visit-n">åˆå›</span></div>
        </div>
      </div>

    </div>
  </aside>

  <!-- MAIN AREA -->
  <div class="main-area">

    <!-- TAB BAR -->
    <div class="tab-bar">
      <button class="tab-btn active" onclick="showTab('karte', this)">ğŸ“‹ ã‚«ãƒ«ãƒ†</button>
      <button class="tab-btn" onclick="showTab('system', this)">âš™ï¸ ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ</button>
      <button class="tab-btn" onclick="showTab('cost', this)">ğŸ’° è²»ç”¨ãƒ»ç„¡æ–™æ§‹æˆ</button>
    </div>

    <!-- ===== KARTE TAB ===== -->
    <div id="tab-karte" class="tab-pane active" style="display:flex;flex-direction:column;height:calc(100vh - 52px - 42px);">
      <div class="scroll-area fade-in">

        <div class="karte-card">
          <!-- Header -->
          <div class="karte-top">
            <div class="karte-top-left">
              <div class="karte-tag">Medical Chart</div>
              <div class="karte-salon">ã‚„ã™ã‚‰ãæ•´ä½“é™¢</div>
            </div>
            <div class="karte-top-right">
              <div class="karte-no">No. 0042</div>
              <div class="karte-date">2025å¹´6æœˆ18æ—¥ï¼ˆæ°´ï¼‰</div>
            </div>
          </div>

          <!-- Patient info -->
          <div class="info-grid">
            <div class="info-col">
              <div class="info-row">
                <div class="lbl">æ°å</div>
                <div class="val name-val">å±±ç”° å¤ªéƒ</div>
              </div>
              <div class="info-row">
                <div class="lbl">ç”Ÿå¹´æœˆæ—¥</div>
                <div class="val">1964å¹´3æœˆ5æ—¥ï¼ˆ60æ­³ï¼‰</div>
              </div>
              <div class="info-row">
                <div class="lbl">æ€§åˆ¥</div>
                <div class="val">ç”·æ€§</div>
              </div>
              <div class="info-row">
                <div class="lbl">è·æ¥­</div>
                <div class="val">ä¼šç¤¾å“¡ï¼ˆãƒ‡ã‚¹ã‚¯ãƒ¯ãƒ¼ã‚¯ï¼‰</div>
              </div>
            </div>
            <div class="info-col">
              <div class="info-row">
                <div class="lbl">é›»è©±</div>
                <div class="val">090-XXXX-XXXX</div>
              </div>
              <div class="info-row">
                <div class="lbl">ä½æ‰€</div>
                <div class="val">æ±äº¬éƒ½æ–°å®¿åŒºã€‡ã€‡</div>
              </div>
              <div class="info-row">
                <div class="lbl">æ¥é™¢å›æ•°</div>
                <div class="val"><strong>5å›ç›®</strong></div>
              </div>
              <div class="info-row">
                <div class="lbl">æ‹…å½“è€…</div>
                <div class="val">ç”°ä¸­ èŠ±å­</div>
              </div>
            </div>
          </div>

          <!-- Chief complaint -->
          <div class="karte-section">
            <div class="section-head">ä¸»è¨´ãƒ»æ¥é™¢ç†ç”±</div>
            <div class="sec-body">
              æ…¢æ€§çš„ãª<strong>è…°ç—›</strong>ãƒ»<strong>å³è‚©ã“ã‚Š</strong>ã€‚ãƒ‡ã‚¹ã‚¯ãƒ¯ãƒ¼ã‚¯ãŒå¤šãå¤•æ–¹ã«ãªã‚‹ã¨æ‚ªåŒ–ã€‚å…ˆé€±ã‹ã‚‰å³ã®<strong>è‚¡é–¢ç¯€</strong>ã«ã‚‚é•å’Œæ„Ÿã‚ã‚Šã€‚
            </div>
          </div>

          <!-- Body diagram -->
          <div class="karte-section">
            <div class="section-head">ç—‡çŠ¶éƒ¨ä½</div>
            <div class="body-area">
              <div class="body-svg-wrap">
                <svg viewBox="0 0 80 200" xmlns="http://www.w3.org/2000/svg">
                  <ellipse cx="40" cy="22" rx="12" ry="14" fill="none" stroke="#c4b08a" stroke-width="1.5"/>
                  <rect x="22" y="36" width="36" height="42" rx="5" fill="none" stroke="#c4b08a" stroke-width="1.5"/>
                  <line x1="22" y1="40" x2="6" y2="82" stroke="#c4b08a" stroke-width="1.5" stroke-linecap="round"/>
                  <line x1="58" y1="40" x2="74" y2="82" stroke="#c4b08a" stroke-width="1.5" stroke-linecap="round"/>
                  <line x1="30" y1="78" x2="26" y2="140" stroke="#c4b08a" stroke-width="1.5" stroke-linecap="round"/>
                  <line x1="50" y1="78" x2="54" y2="140" stroke="#c4b08a" stroke-width="1.5" stroke-linecap="round"/>
                  <line x1="26" y1="140" x2="22" y2="190" stroke="#c4b08a" stroke-width="1.5" stroke-linecap="round"/>
                  <line x1="54" y1="140" x2="58" y2="190" stroke="#c4b08a" stroke-width="1.5" stroke-linecap="round"/>
                  <!-- å³è‚© -->
                  <circle cx="58" cy="42" r="7" fill="rgba(176,48,48,0.2)" stroke="#b03030" stroke-width="1.5"/>
                  <text x="58" y="46" text-anchor="middle" font-size="8" fill="#b03030">â—</text>
                  <!-- è…° -->
                  <circle cx="40" cy="70" r="8" fill="rgba(176,48,48,0.2)" stroke="#b03030" stroke-width="1.5"/>
                  <text x="40" y="74" text-anchor="middle" font-size="8" fill="#b03030">â—</text>
                  <!-- å³è‚¡é–¢ç¯€ -->
                  <circle cx="52" cy="90" r="6" fill="rgba(176,48,48,0.12)" stroke="#b03030" stroke-width="1" stroke-dasharray="3,2"/>
                </svg>
              </div>
              <div class="pain-info">
                <div style="font-size:0.67rem;color:var(--ink-soft);margin-bottom:7px;letter-spacing:0.08em">è¨˜éŒ²ã•ã‚ŒãŸç—‡çŠ¶éƒ¨ä½</div>
                <span class="pain-tag">å³è‚©ã“ã‚Š â—</span>
                <span class="pain-tag">è…°ç—›ï¼ˆä¸­ç¨‹åº¦ï¼‰ â—</span>
                <span class="pain-tag">å³è‚¡é–¢ç¯€ é•å’Œæ„Ÿ</span>
                <div class="pain-detail">
                  ç—›ã¿ãƒ¬ãƒ™ãƒ«ï¼š<strong style="color:var(--red)">6 / 10</strong>ï¼ˆè…°ï¼‰<br>
                  ç™ºç—‡ï¼š<strong>2å¹´å‰</strong>ã‹ã‚‰æ…¢æ€§çš„ã«<br>
                  å¢—æ‚ªå› å­ï¼šé•·æ™‚é–“åº§ä½ãƒ»å¤•æ–¹ä»¥é™
                </div>
              </div>
            </div>
          </div>

          <!-- Treatment record -->
          <div class="karte-section">
            <div class="section-head">æœ¬æ—¥ã®æ–½è¡“è¨˜éŒ²ï¼ˆç¬¬5å›ï¼‰</div>
            <div class="visit-box" style="margin-top:12px">
              <div class="visit-head">
                <span>æ–½è¡“è¨˜éŒ²</span>
                <span>2025.06.18ã€€13:00ã€œ13:50</span>
              </div>
              <div class="visit-body">
                <div class="vrow">
                  <span class="vlbl">æœ¬æ—¥ã®è¨´ãˆ</span>
                  <span>å…ˆé€±ã‚ˆã‚Šè…°ã®å¼µã‚ŠãŒå¼·ã„ã€‚åœ¨å®…å‹¤å‹™ãŒç¶šãã€é•·æ™‚é–“åŒå§¿å‹¢ã«ãªã£ã¦ã„ã‚‹ã€‚</span>
                </div>
                <div class="vrow">
                  <span class="vlbl">æ‰€è¦‹</span>
                  <span>L4-L5å‘¨è¾ºã«å¼·ã„ç­‹ç·Šå¼µã€‚å³æ¢¨çŠ¶ç­‹ã«åœ§ç—›ã‚ã‚Šã€‚éª¨ç›¤ã®å·¦å›æ—‹ã‚’ç¢ºèªã€‚</span>
                </div>
                <div class="vrow">
                  <span class="vlbl">æ–½è¡“å†…å®¹</span>
                  <span>éª¨ç›¤çŸ¯æ­£ãƒ»è…°éƒ¨ã‚¹ãƒˆãƒ¬ãƒƒãƒãƒ»å³è‚©åƒ§å¸½ç­‹ãƒªãƒªãƒ¼ã‚¹ãƒ»è‚¡é–¢ç¯€ãƒ¢ãƒ“ãƒªã‚¼ãƒ¼ã‚·ãƒ§ãƒ³</span>
                </div>
                <div class="vrow">
                  <span class="vlbl">æ–½è¡“å¾Œ</span>
                  <span>è…°ã®å¼µã‚Šè»½æ¸›ï¼ˆ6â†’3/10ï¼‰ã€‚å¯å‹•åŸŸæ”¹å–„ã€‚è‚¡é–¢ç¯€é•å’Œæ„Ÿã‚‚ã‚„ã‚„ç·©å’Œã€‚</span>
                </div>
                <div class="vrow">
                  <span class="vlbl">æ¬¡å›ç”³ã—é€ã‚Š</span>
                  <span>è‚¡é–¢ç¯€ã®ç¶™ç¶šè©•ä¾¡ã€‚ãƒ‡ã‚¹ã‚¯ç’°å¢ƒã®æ”¹å–„æŒ‡å°ã‚’æ¤œè¨ã€‚</span>
                </div>
              </div>
            </div>
          </div>

        </div><!-- /karte-card -->
      </div><!-- /scroll-area -->

      <!-- VOICE PANEL (fixed at bottom) -->
      <div class="voice-panel">
        <div class="voice-panel-inner">
          <div class="mic-wrap">
            <button class="mic-btn" id="micBtn" onclick="toggleMic()">
              <svg viewBox="0 0 24 24"><path d="M12 1a4 4 0 0 1 4 4v6a4 4 0 0 1-8 0V5a4 4 0 0 1 4-4zm-7 10a7 7 0 0 0 14 0h2a9 9 0 0 1-8 8.94V22h-2v-2.06A9 9 0 0 1 3 11h2z"/></svg>
            </button>
            <div class="mic-label" id="micLabel">éŒ²éŸ³é–‹å§‹</div>
          </div>
          <div class="voice-input-area">
            <textarea class="voice-textarea" id="voiceText" placeholder="ãƒã‚¤ã‚¯ã‚’ã‚¿ãƒƒãƒ— â†’ è©±ã™ã ã‘ã§ã‚«ãƒ«ãƒ†ã«è¨˜éŒ²&#10;ä¾‹ï¼šã€Œè…°ã®å³å´ãŒ7ç‚¹ãã‚‰ã„ã®ç—›ã¿ã€æ˜¨æ—¥ã‹ã‚‰æ‚ªåŒ–ã—ãŸã€"></textarea>
            <div class="voice-hint">ğŸ’¡ Web Speech API ä½¿ç”¨ï¼ˆç„¡æ–™ï¼‰</div>
          </div>
          <div class="voice-btns">
            <button class="vbtn vbtn-parse" onclick="parseVoice()">ğŸ¤– AIè§£æãƒ»åæ˜ </button>
            <button class="vbtn vbtn-save"  onclick="saveGAS()">ğŸ“Š GASã§ä¿å­˜</button>
          </div>
        </div>
      </div>
    </div>

    <!-- ===== SYSTEM TAB ===== -->
    <div id="tab-system" class="tab-pane">
      <div class="scroll-area fade-in-2">
        <div class="system-wrap">

          <div class="sys-card">
            <div class="sys-card-head">ğŸ”„ ã‚·ã‚¹ãƒ†ãƒ ãƒ•ãƒ­ãƒ¼</div>
            <div class="sys-card-body">
              <div class="flow-row">
                <div class="flow-node">
                  <div class="flow-icon" style="background:#f5ede0">ğŸ™ï¸</div>
                  <div class="fn-name">éŸ³å£°å…¥åŠ›</div>
                  <div class="fn-sub">Web Speech API</div>
                  <span class="fn-badge" style="background:#f5eee8;color:#7a5c38;border:1px solid #d4b07a">ãƒ–ãƒ©ã‚¦ã‚¶æ¨™æº–</span>
                </div>
                <div class="flow-arrow">â†’</div>
                <div class="flow-node">
                  <div class="flow-icon" style="background:#e8f5f5">âš™ï¸</div>
                  <div class="fn-name">GAS å‡¦ç†</div>
                  <div class="fn-sub">Apps Script</div>
                  <span class="fn-badge" style="background:#e8f5f5;color:#2d6a6a;border:1px solid #90c8c8">è‡ªå‹•åŒ–</span>
                </div>
                <div class="flow-arrow">â†’</div>
                <div class="flow-node">
                  <div class="flow-icon" style="background:#eafaf1">ğŸ“Š</div>
                  <div class="fn-name">ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆ</div>
                  <div class="fn-sub">Google Sheets</div>
                  <span class="fn-badge" style="background:#eafaf1;color:#1e7a40;border:1px solid #80d8a0">ä¿å­˜ãƒ»ç®¡ç†</span>
                </div>
                <div class="flow-arrow">â†’</div>
                <div class="flow-node">
                  <div class="flow-icon" style="background:#fff5e8">ğŸ–¨ï¸</div>
                  <div class="fn-name">PDFå‡ºåŠ›</div>
                  <div class="fn-sub">GASè‡ªå‹•ç”Ÿæˆ</div>
                  <span class="fn-badge" style="background:#fff5e8;color:#b8935a;border:1px solid #d4b07a">å°åˆ·å¯¾å¿œ</span>
                </div>
              </div>

              <div style="margin-top:16px;padding:12px 14px;background:#f8f4ec;border:1px solid var(--border);border-radius:var(--radius);font-size:0.72rem;color:var(--ink-mid);line-height:2">
                <strong style="color:var(--teal)">GAS ãŒè‡ªå‹•åŒ–ã™ã‚‹ã“ã¨ï¼š</strong>
                ãƒ‡ãƒ¼ã‚¿å—ä¿¡ãƒ»æ•´å½¢ â†’ ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆæ›¸ãè¾¼ã¿ â†’ PDFå‡ºåŠ› â†’ ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ãƒ¡ãƒ¼ãƒ«é€ä¿¡ â†’ æœˆæ¬¡ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
              </div>
            </div>
          </div>

          <div class="sys-card">
            <div class="sys-card-head">âœ¨ ä¸»è¦æ©Ÿèƒ½</div>
            <div class="sys-card-body">
              <div class="feature-grid">
                <div class="feat">
                  <h4>ğŸ™ï¸ éŸ³å£°â†’ã‚«ãƒ«ãƒ†å¤‰æ›</h4>
                  <p>Web Speech APIã§ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ–‡å­—èµ·ã“ã—ã€‚GASå´ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰è§£æã§ã€Œä¸»è¨´ãƒ»ç—›ã¿ãƒ¬ãƒ™ãƒ«ãƒ»éƒ¨ä½ã€ã‚’è‡ªå‹•åˆ†é¡ã—ã¦ã‚«ãƒ«ãƒ†ã«åæ˜ ã€‚</p>
                </div>
                <div class="feat">
                  <h4>âš™ï¸ GAS å®Œå…¨è‡ªå‹•åŒ–</h4>
                  <p>ãƒ•ãƒ­ãƒ³ãƒˆã‹ã‚‰fetch()ã§GASã®doPost()ã‚’å‘¼ã³å‡ºã—ã€‚æ‚£è€…IDã‚’ã‚­ãƒ¼ã«ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã¸è‡ªå‹•æ›¸ãè¾¼ã¿ã€‚ã‚µãƒ¼ãƒãƒ¼ä¸è¦ã€‚</p>
                </div>
                <div class="feat">
                  <h4>ğŸ“Š ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆç®¡ç†</h4>
                  <p>æ‚£è€…ãƒã‚¹ã‚¿ãƒ»æ¥é™¢è¨˜éŒ²ã®2ã‚·ãƒ¼ãƒˆæ§‹æˆã€‚Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã ã‘ã§å®Œçµã€‚ãƒ•ã‚£ãƒ«ã‚¿ãƒ»æ¤œç´¢ãƒ»CSVå‡ºåŠ›ã‚‚æ¨™æº–æ©Ÿèƒ½ã§å¯¾å¿œã€‚</p>
                </div>
                <div class="feat">
                  <h4>ğŸ“± ã‚¹ãƒãƒ›å¯¾å¿œUI</h4>
                  <p>PCãƒ»ã‚¹ãƒãƒ›ã©ã¡ã‚‰ã§ã‚‚å‹•ä½œã€‚Googleãƒ‰ãƒ©ã‚¤ãƒ–ã«ç½®ã„ã¦ã‚¦ã‚§ãƒ–å…¬é–‹ã™ã‚‹ã ã‘ã§å³ä½¿ãˆã‚‹ã€‚ã‚¢ãƒ—ãƒªä¸è¦ã€‚</p>
                </div>
              </div>
            </div>
          </div>

          <div class="sys-card">
            <div class="sys-card-head">ğŸ“‹ ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆæ§‹æˆ</div>
            <div class="sys-card-body">
              <div class="sheet-grid">
                <div class="sheet-card">
                  <div class="sheet-head">â‘  æ‚£è€…ãƒã‚¹ã‚¿ã‚·ãƒ¼ãƒˆ</div>
                  <div class="sheet-body">
                    æ‚£è€…IDï¼ˆè‡ªå‹•æ¡ç•ªï¼‰<br>
                    æ°åãƒ»ç”Ÿå¹´æœˆæ—¥ãƒ»æ€§åˆ¥<br>
                    é›»è©±ç•ªå·ãƒ»ä½æ‰€<br>
                    è·æ¥­ãƒ»æ—¢å¾€æ­´<br>
                    åˆå›æ¥é™¢æ—¥ãƒ»ç´¯è¨ˆå›æ•°
                  </div>
                </div>
                <div class="sheet-card">
                  <div class="sheet-head">â‘¡ æ¥é™¢è¨˜éŒ²ã‚·ãƒ¼ãƒˆ</div>
                  <div class="sheet-body">
                    æ¥é™¢æ—¥ãƒ»æ‚£è€…IDãƒ»å›æ•°<br>
                    æ‹…å½“è€…ãƒ»ä¸»è¨´<br>
                    æ‰€è¦‹ãƒ»æ–½è¡“å†…å®¹<br>
                    æ–½è¡“å¾Œã®çŠ¶æ…‹<br>
                    æ¬¡å›ç”³ã—é€ã‚Šãƒ»éŸ³å£°åŸæ–‡
                  </div>
                </div>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>

    <!-- ===== COST TAB ===== -->
    <div id="tab-cost" class="tab-pane">
      <div class="scroll-area fade-in-3">
        <div class="system-wrap">

          <div class="sys-card">
            <div class="sys-card-head">ğŸ’° è²»ç”¨å†…è¨³ï¼ˆã™ã¹ã¦ç„¡æ–™ã§æ§‹ç¯‰å¯èƒ½ï¼‰</div>
            <div class="sys-card-body">
              <div class="cost-row">
                <div>
                  <div class="cost-name">ğŸ™ï¸ Web Speech APIï¼ˆéŸ³å£°â†’ãƒ†ã‚­ã‚¹ãƒˆï¼‰</div>
                  <div class="cost-note">Chromeãƒ»Safariã«æ¨™æº–æ­è¼‰ã€‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¸è¦ã€‚</div>
                </div>
                <div class="cost-free">Â¥0</div>
              </div>
              <div class="cost-row">
                <div>
                  <div class="cost-name">âš™ï¸ Google Apps Script</div>
                  <div class="cost-note">Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒã‚ã‚Œã°ç„¡æ–™ã§åˆ©ç”¨å¯èƒ½ã€‚</div>
                </div>
                <div class="cost-free">Â¥0</div>
              </div>
              <div class="cost-row">
                <div>
                  <div class="cost-name">ğŸ“Š Google ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆ</div>
                  <div class="cost-note">ãƒ‡ãƒ¼ã‚¿ä¿å­˜ãƒ»ç®¡ç†ãƒ»CSVå‡ºåŠ›ã¾ã§ç„¡æ–™ã€‚</div>
                </div>
                <div class="cost-free">Â¥0</div>
              </div>
              <div class="cost-row">
                <div>
                  <div class="cost-name">ğŸŒ Googleãƒ‰ãƒ©ã‚¤ãƒ– ã‚¦ã‚§ãƒ–å…¬é–‹</div>
                  <div class="cost-note">HTMLã‚’ã‚¢ãƒƒãƒ—ã—ã¦URLã‚’å…±æœ‰ã™ã‚‹ã ã‘ã€‚</div>
                </div>
                <div class="cost-free">Â¥0</div>
              </div>
              <div class="cost-row">
                <div>
                  <div class="cost-name">ğŸ¤– AIè§£æï¼ˆã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æŠ½å‡º by GASï¼‰</div>
                  <div class="cost-note">æ­£è¦è¡¨ç¾ï¼‹è¾æ›¸ã§ç—‡çŠ¶ã‚’è‡ªå‹•åˆ†é¡ã€‚ChatGPT APIä¸ä½¿ç”¨ã€‚</div>
                </div>
                <div class="cost-free">Â¥0</div>
              </div>
              <div style="margin-top:16px;padding:14px;background:linear-gradient(135deg,#eafaf1,#e8f8f0);border:1px solid #80d8a0;border-radius:var(--radius);text-align:center">
                <div style="font-family:'Noto Serif JP',serif;font-size:1.1rem;color:var(--green);letter-spacing:0.15em">åˆè¨ˆï¼šå®Œå…¨ç„¡æ–™</div>
                <div style="font-size:0.72rem;color:var(--ink-soft);margin-top:4px">Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆ1ã¤ã‚ã‚Œã°ä»Šæ—¥ã‹ã‚‰ä½¿ãˆã¾ã™</div>
              </div>
            </div>
          </div>

          <div class="sys-card">
            <div class="sys-card-head">ğŸš€ å°å…¥ã‚¹ãƒ†ãƒƒãƒ—</div>
            <div class="sys-card-body">
              <div style="display:flex;flex-direction:column;gap:10px">
                <div style="display:flex;gap:12px;align-items:flex-start">
                  <div style="width:28px;height:28px;background:var(--teal);color:white;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:0.78rem;flex-shrink:0;margin-top:1px">1</div>
                  <div>
                    <div style="font-size:0.82rem;font-weight:500;color:var(--ink)">Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã‚’æº–å‚™</div>
                    <div style="font-size:0.7rem;color:var(--ink-soft);margin-top:2px">æ‚£è€…ãƒã‚¹ã‚¿ãƒ»æ¥é™¢è¨˜éŒ²ã®2ã‚·ãƒ¼ãƒˆã‚’ä½œæˆ</div>
                  </div>
                </div>
                <div style="display:flex;gap:12px;align-items:flex-start">
                  <div style="width:28px;height:28px;background:var(--teal);color:white;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:0.78rem;flex-shrink:0;margin-top:1px">2</div>
                  <div>
                    <div style="font-size:0.82rem;font-weight:500;color:var(--ink)">GASã«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’è²¼ã‚Šä»˜ã‘</div>
                    <div style="font-size:0.7rem;color:var(--ink-soft);margin-top:2px">ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®ã€Œæ‹¡å¼µæ©Ÿèƒ½ã€â†’ã€ŒApps Scriptã€ã‹ã‚‰è¨­å®šã€‚doPost()é–¢æ•°ã§ãƒ‡ãƒ¼ã‚¿å—ä¿¡ã€‚</div>
                  </div>
                </div>
                <div style="display:flex;gap:12px;align-items:flex-start">
                  <div style="width:28px;height:28px;background:var(--teal);color:white;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:0.78rem;flex-shrink:0;margin-top:1px">3</div>
                  <div>
                    <div style="font-size:0.82rem;font-weight:500;color:var(--ink)">GASã‚’ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã¨ã—ã¦ãƒ‡ãƒ—ãƒ­ã‚¤</div>
                    <div style="font-size:0.7rem;color:var(--ink-soft);margin-top:2px">ã€Œãƒ‡ãƒ—ãƒ­ã‚¤ã€â†’ã€Œæ–°ã—ã„ãƒ‡ãƒ—ãƒ­ã‚¤ã€â†’ URLã‚’ã‚³ãƒ”ãƒ¼</div>
                  </div>
                </div>
                <div style="display:flex;gap:12px;align-items:flex-start">
                  <div style="width:28px;height:28px;background:var(--teal);color:white;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:0.78rem;flex-shrink:0;margin-top:1px">4</div>
                  <div>
                    <div style="font-size:0.82rem;font-weight:500;color:var(--ink)">HTMLãƒ•ã‚¡ã‚¤ãƒ«ã®GAS URLã‚’å·®ã—æ›¿ãˆã¦å®Œæˆ</div>
                    <div style="font-size:0.7rem;color:var(--ink-soft);margin-top:2px">Googleãƒ‰ãƒ©ã‚¤ãƒ–ã«ç½®ã„ã¦URLã‚’ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ã€‚ã‚¹ãƒãƒ›ã®ãƒ›ãƒ¼ãƒ ç”»é¢ã«è¿½åŠ ã™ã‚Œã°ã‚¢ãƒ—ãƒªæ„Ÿè¦šã§ä½¿ãˆã¾ã™ã€‚</div>
                  </div>
                </div>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>

  </div><!-- /main-area -->
</div><!-- /app-layout -->

<script>
// ===== MENU =====
function toggleMenu() {
  document.getElementById('sidebar').classList.toggle('open');
  document.getElementById('overlay').classList.toggle('show');
}
function closeMenu() {
  document.getElementById('sidebar').classList.remove('open');
  document.getElementById('overlay').classList.remove('show');
}

// ===== TABS =====
function showTab(name, btn) {
  document.querySelectorAll('.tab-pane').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  document.getElementById('tab-' + name).classList.add('active');
  btn.classList.add('active');
}

// ===== PATIENT SELECT =====
function selectPatient(el, name) {
  document.querySelectorAll('.patient-item').forEach(p => p.classList.remove('active'));
  el.classList.add('active');
  closeMenu();
}

// ===== MIC =====
let isRecording = false;
let recognition = null;
let demoTimer = null;

function toggleMic() {
  isRecording = !isRecording;
  const btn = document.getElementById('micBtn');
  const lbl = document.getElementById('micLabel');

  if (isRecording) {
    btn.classList.add('rec');
    lbl.textContent = 'éŒ²éŸ³ä¸­...';

    // Web Speech API (å®Ÿéš›ã®å®Ÿè£…)
    if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
      const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
      recognition = new SR();
      recognition.lang = 'ja-JP';
      recognition.continuous = true;
      recognition.interimResults = true;
      recognition.onresult = (e) => {
        let txt = '';
        for (let i = e.resultIndex; i < e.results.length; i++) {
          txt += e.results[i][0].transcript;
        }
        document.getElementById('voiceText').value = txt;
      };
      recognition.start();
    } else {
      // ãƒ‡ãƒ¢ç”¨ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
      demoTimer = setTimeout(() => {
        document.getElementById('voiceText').value =
          'æ‚£è€…ã•ã‚“ã€ä»Šæ—¥ã¯è…°ã®å¼µã‚ŠãŒã‹ãªã‚Šå¼·ã„ã¨ãŠã£ã—ã‚ƒã£ã¦ã„ã¾ã™ã€‚å…ˆé€±ã‚ˆã‚Šæ‚ªåŒ–ã—ã¦ã„ã¦ã€åœ¨å®…å‹¤å‹™ãŒç¶šã„ãŸå½±éŸ¿ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚å³ã®è‚¡é–¢ç¯€ã«ã‚‚é•å’Œæ„ŸãŒã‚ã£ã¦ã€æ­©ãã¨ãã«å¼•ã£ã‹ã‹ã‚Šã‚’æ„Ÿã˜ã‚‹ã€‚è…°ã®ç—›ã¿ã¯7ç‚¹ãã‚‰ã„ã€‚';
      }, 2000);
    }
  } else {
    btn.classList.remove('rec');
    lbl.textContent = 'éŒ²éŸ³å®Œäº† âœ“';
    setTimeout(() => { lbl.textContent = 'éŒ²éŸ³é–‹å§‹'; }, 3000);
    if (recognition) { recognition.stop(); recognition = null; }
    if (demoTimer) { clearTimeout(demoTimer); demoTimer = null; }
  }
}

// ===== GAS URL =====
const GAS_URL = 'https://script.google.com/macros/s/AKfycbynwh9DJp2_kpU2ZS_hLkvt4fSwyfn7fMldIQUZR8JKA-PKbaek7SzVLBWmBQbN7Cxl/exec';

// ===== PARSEï¼ˆGASã§è§£æï¼‰ =====
async function parseVoice() {
  const text = document.getElementById('voiceText').value.trim();
  if (!text) { alert('ã¾ãšéŸ³å£°ã‚’éŒ²éŸ³ã—ã¦ãã ã•ã„'); return; }

  const lbl = document.getElementById('micLabel');
  lbl.textContent = 'è§£æä¸­...';

  try {
    // ã¾ãšãƒ­ãƒ¼ã‚«ãƒ«ã§å³æ™‚è§£æã—ã¦UIã«åæ˜ 
    const parsed = localParse(text);
    showParsedResult(parsed, text);
    lbl.textContent = 'è§£æå®Œäº† âœ“';
    setTimeout(() => { lbl.textContent = 'éŒ²éŸ³é–‹å§‹'; }, 3000);
  } catch (err) {
    lbl.textContent = 'éŒ²éŸ³é–‹å§‹';
    alert('è§£æã‚¨ãƒ©ãƒ¼ï¼š' + err.message);
  }
}

// ãƒ­ãƒ¼ã‚«ãƒ«ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰è§£æï¼ˆå³æ™‚ãƒ»ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§ã‚‚å‹•ãï¼‰
function localParse(text) {
  const partDict = [
    { key: 'è…°',     label: 'è…°éƒ¨' },
    { key: 'è‚©',     label: 'è‚©' },
    { key: 'é¦–',     label: 'é ¸éƒ¨' },
    { key: 'é ¸',     label: 'é ¸éƒ¨' },
    { key: 'èƒŒä¸­',   label: 'èƒŒéƒ¨' },
    { key: 'è‚¡é–¢ç¯€', label: 'è‚¡é–¢ç¯€' },
    { key: 'è†',     label: 'è†é–¢ç¯€' },
    { key: 'è¶³é¦–',   label: 'è¶³é–¢ç¯€' },
    { key: 'æ‰‹é¦–',   label: 'æ‰‹é–¢ç¯€' },
    { key: 'è‚˜',     label: 'è‚˜é–¢ç¯€' },
    { key: 'é ­',     label: 'é ­éƒ¨' },
    { key: 'éª¨ç›¤',   label: 'éª¨ç›¤' },
  ];
  const parts = [];
  partDict.forEach(({ key, label }) => {
    if (text.includes(key) && !parts.includes(label)) parts.push(label);
  });
  const levelMatch = text.match(/([0-9]+)\s*[ç‚¹\/]/);
  return {
    painParts: parts,
    painLevel: levelMatch ? levelMatch[1] : null,
    chiefComplaint: text,
  };
}

// è§£æçµæœã‚’ã‚«ãƒ«ãƒ†UIã«åæ˜ 
function showParsedResult(parsed, rawText) {
  // è§£æçµæœã‚’ã‚¢ãƒ©ãƒ¼ãƒˆã§è¡¨ç¤º
  const lines = [
    'âœ… è§£æå®Œäº† â†’ ã‚«ãƒ«ãƒ†ã«åæ˜ ã—ã¾ã—ãŸ',
    '',
    'ç—‡çŠ¶éƒ¨ä½ï¼š' + (parsed.painParts.length ? parsed.painParts.join('ãƒ»') : 'æœªæ¤œå‡º'),
    'ç—›ã¿ãƒ¬ãƒ™ãƒ«ï¼š' + (parsed.painLevel ? parsed.painLevel + '/10' : 'æœªè¨˜è¼‰'),
    '',
    'ä¸»è¨´ï¼ˆéŸ³å£°åŸæ–‡ï¼‰ï¼š',
    rawText,
  ];
  alert(lines.join('\n'));
}

// ===== SAVEï¼ˆGASã§ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«ä¿å­˜ï¼‰ =====
async function saveGAS() {
  const text = document.getElementById('voiceText').value.trim();
  if (!text) { alert('éŸ³å£°ãƒ†ã‚­ã‚¹ãƒˆãŒã‚ã‚Šã¾ã›ã‚“ã€‚å…ˆã«éŒ²éŸ³ã—ã¦ãã ã•ã„ã€‚'); return; }

  const lbl = document.getElementById('micLabel');
  lbl.textContent = 'ä¿å­˜ä¸­...';

  // è§£æã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’çµ„ã¿ç«‹ã¦ã‚‹
  const parsed = localParse(text);

  // ç¾åœ¨é¸æŠä¸­ã®æ‚£è€…åã‚’å–å¾—
  const activePatient = document.querySelector('.patient-item.active .p-name');
  const patientName   = activePatient ? activePatient.textContent : 'æœªé¸æŠ';

  const payload = {
    action:         'saveVisit',
    patientId:      'P0001',            // â€»å®Ÿè£…æ™‚ã¯é¸æŠä¸­ã®æ‚£è€…IDã‚’ä½¿ç”¨
    therapist:      'ç”°ä¸­ èŠ±å­',         // â€»å®Ÿè£…æ™‚ã¯ãƒ­ã‚°ã‚¤ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’ä½¿ç”¨
    chiefComplaint: parsed.chiefComplaint,
    painLevel:      parsed.painLevel || '',
    painParts:      parsed.painParts.join('ãƒ»'),
    findings:       '',
    treatment:      '',
    afterState:     '',
    nextNote:       '',
    voiceText:      text,
  };

  try {
    // GASã«POSTé€ä¿¡ï¼ˆno-corsã®ãŸã‚ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¯èª­ã‚ãªã„ãŒæ›¸ãè¾¼ã¿ã¯å®Ÿè¡Œã•ã‚Œã‚‹ï¼‰
    await fetch(GAS_URL, {
      method:  'POST',
      headers: { 'Content-Type': 'text/plain' },
      body:    JSON.stringify(payload),
      mode:    'no-cors',
    });

    lbl.textContent = 'ä¿å­˜å®Œäº† âœ“';
    setTimeout(() => { lbl.textContent = 'éŒ²éŸ³é–‹å§‹'; }, 3000);

    alert(
      'ğŸ“Š ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«ä¿å­˜ã—ã¾ã—ãŸï¼\n\n' +
      'æ‚£è€…ï¼š' + patientName + '\n' +
      'ç—‡çŠ¶éƒ¨ä½ï¼š' + (parsed.painParts.join('ãƒ»') || 'æœªæ¤œå‡º') + '\n' +
      'ç—›ã¿ãƒ¬ãƒ™ãƒ«ï¼š' + (parsed.painLevel ? parsed.painLevel + '/10' : 'æœªè¨˜è¼‰') + '\n\n' +
      'Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã®ã€Œæ¥é™¢è¨˜éŒ²ã€ã‚·ãƒ¼ãƒˆã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚'
    );

    // é€ä¿¡å¾Œã«ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã‚’ã‚¯ãƒªã‚¢
    document.getElementById('voiceText').value = '';

  } catch (err) {
    lbl.textContent = 'éŒ²éŸ³é–‹å§‹';
    alert('ä¿å­˜ã‚¨ãƒ©ãƒ¼ï¼š' + err.message + '\n\nGAS URLã‚„ãƒãƒƒãƒˆæ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚');
  }
}
</script>
</body>
</html>
